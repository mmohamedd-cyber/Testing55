<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Grade 6 ICT Worksheet — Spreadsheets & Word Processing</title>

  <style>
    :root{
      --bg:#0b1220;
      --card:#111a2e;
      --text:#e9eefc;
      --muted:#b9c3e6;
      --accent:#4da3ff;
      --accent2:#7cffc4;
      --danger:#ff6b6b;
      --border: rgba(255,255,255,.12);
      --shadow: 0 12px 40px rgba(0,0,0,.35);
      --radius:16px;
      --radius2:12px;
    }
    *{box-sizing:border-box}
    body{
      margin:0;
      font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial;
      background:
        radial-gradient(900px 600px at 15% 10%, rgba(77,163,255,.22), transparent 60%),
        radial-gradient(900px 600px at 90% 25%, rgba(124,255,196,.14), transparent 55%),
        linear-gradient(180deg, #070b14, var(--bg));
      color:var(--text);
      padding:24px;
    }
    .wrap{max-width:980px;margin:0 auto}
    header{
      display:flex; gap:14px; align-items:flex-start; justify-content:space-between;
      padding:18px 18px 14px;
      background: linear-gradient(180deg, rgba(255,255,255,.06), rgba(255,255,255,.03));
      border:1px solid var(--border);
      border-radius: var(--radius);
      box-shadow: var(--shadow);
    }
    .title{display:flex; flex-direction:column; gap:6px;}
    .title h1{margin:0;font-size:20px;letter-spacing:.2px}
    .title p{margin:0;color:var(--muted);font-size:13.5px;line-height:1.35}
    .pill{
      display:inline-flex; gap:8px; align-items:center;
      padding:8px 10px;border-radius:999px;
      background: rgba(77,163,255,.12);
      border:1px solid rgba(77,163,255,.25);
      color: var(--text);font-size:12.5px;white-space:nowrap;height:fit-content;
    }

    .card{
      margin-top:16px;
      background: rgba(255,255,255,.05);
      border:1px solid var(--border);
      border-radius: var(--radius);
      box-shadow: var(--shadow);
      overflow:hidden;
    }
    .card .card-head{
      padding:14px 18px;
      background: linear-gradient(180deg, rgba(255,255,255,.06), rgba(255,255,255,.02));
      border-bottom:1px solid var(--border);
      display:flex; gap:12px; align-items:center; justify-content:space-between;
    }
    .card .card-head h2{margin:0;font-size:15px}
    .hint{color:var(--muted);font-size:12.5px}
    .card .card-body{padding:18px}

    .grid{display:grid;grid-template-columns: 1fr 1fr;gap:14px;}
    @media (max-width:700px){
      .grid{grid-template-columns:1fr}
      header{flex-direction:column}
      .pill{width:fit-content}
    }
    label{display:block;font-size:13px;color: var(--muted);margin-bottom:7px;}
    input[type="text"], textarea{
      width:100%;
      padding:12px 12px;border-radius: var(--radius2);
      border:1px solid rgba(255,255,255,.14);
      background: rgba(17,26,46,.55);
      color: var(--text);
      outline:none;
      transition: border .15s ease, box-shadow .15s ease;
    }
    textarea{min-height:92px;resize:vertical}
    input[type="text"]:focus, textarea:focus{
      border-color: rgba(77,163,255,.55);
      box-shadow: 0 0 0 4px rgba(77,163,255,.12);
    }

    .q{
      background: rgba(17,26,46,.45);
      border:1px solid rgba(255,255,255,.10);
      border-radius: var(--radius);
      padding:14px 14px 12px;
      margin-bottom:12px;
      position:relative;
    }
    .q:last-child{margin-bottom:0}
    .q .q-top{display:flex; gap:10px; align-items:flex-start; justify-content:space-between; margin-bottom:10px;}
    .q .q-num{
      display:inline-flex;width:30px;height:30px;align-items:center;justify-content:center;
      border-radius:10px;
      background: rgba(124,255,196,.12);
      border:1px solid rgba(124,255,196,.22);
      color: var(--text);font-weight:700;flex:0 0 auto;
    }
    .q .q-text{margin:0;font-size:14px;line-height:1.35;color:var(--text)}
    .q .q-sub{margin:6px 0 0;color:var(--muted);font-size:12.5px}

    .choices{display:grid;grid-template-columns: 1fr 1fr;gap:10px;margin-top:10px;}
    @media (max-width:700px){ .choices{grid-template-columns:1fr} }
    .choice{
      display:flex;gap:10px;align-items:flex-start;
      padding:10px 10px;border-radius:14px;
      border:1px solid rgba(255,255,255,.12);
      background: rgba(15,24,48,.55);
      cursor:pointer;user-select:none;
      transition: border .15s ease, box-shadow .15s ease;
    }
    .choice:hover{
      border-color: rgba(124,255,196,.28);
      box-shadow: 0 0 0 4px rgba(124,255,196,.08);
    }
    .choice input{margin-top:2px}
    .choice span{font-size:13.5px;color:var(--text);line-height:1.3}

    .actions{
      display:flex; gap:12px; align-items:center; justify-content:space-between;
      margin-top:16px;padding-top:14px;border-top:1px solid var(--border);
    }
    button{
      border:none;border-radius:14px;
      padding:12px 14px;font-weight:700;cursor:pointer;
      transition: opacity .15s ease;
    }
    .btn-primary{
      background: linear-gradient(90deg, rgba(77,163,255,.95), rgba(124,255,196,.75));
      color:#07101d;
    }
    .btn-ghost{
      background: rgba(255,255,255,.06);
      border:1px solid rgba(255,255,255,.12);
      color: var(--text);
    }
    .btn-primary[disabled]{opacity:.55;cursor:not-allowed}
    .status{font-size:13px;color: var(--muted);}
    .status strong{color: var(--text)}

    .invalid{
      border-color: rgba(255,107,107,.7) !important;
      box-shadow: 0 0 0 4px rgba(255,107,107,.14) !important;
    }
    .q.invalid-block{
      border-color: rgba(255,107,107,.55);
      box-shadow: 0 0 0 4px rgba(255,107,107,.08);
    }

    .msg{
      display:none;
      margin-top:12px;
      padding:12px 14px;
      border-radius: 14px;
      border:1px solid rgba(255,255,255,.14);
      background: rgba(255,255,255,.06);
      color: var(--text);
      font-size:13px;
      line-height:1.35;
    }
    .msg.show{display:block}
    .msg.err{
      border-color: rgba(255,107,107,.35);
      background: rgba(255,107,107,.10);
      color:#ffe8e8;
    }
    .msg.ok{
      border-color: rgba(124,255,138,.35);
      background: rgba(124,255,138,.10);
      color:#eaffef;
    }

    .small{font-size:12px;color:var(--muted)}
    code.inline{background:rgba(255,255,255,.08);padding:2px 6px;border-radius:8px;border:1px solid rgba(255,255,255,.10)}
  </style>
</head>

<body>
  <div class="wrap">
    <header>
      <div class="title">
        <h1>Grade 6 ICT — Interactive Worksheet</h1>
        <p>Topic: <strong>Spreadsheets</strong> & <strong>Word Processing</strong></p>
        <p class="small">When you press <strong>Submit</strong>, your answers are saved automatically.</p>
      </div>
      <div class="pill">Answered: <strong id="answeredCount">0</strong>/12</div>
    </header>

    <div class="card">
      <div class="card-head">
        <h2>Student Details</h2>
        <div class="hint">Both names are required.</div>
      </div>
      <div class="card-body">
        <div class="grid">
          <div>
            <label for="firstName">First name</label>
            <input type="text" id="firstName" placeholder="e.g., Aisha" />
          </div>
          <div>
            <label for="secondName">Second name</label>
            <input type="text" id="secondName" placeholder="e.g., Ahmed" />
          </div>
        </div>

        <div class="msg err" id="topError"></div>
        <div class="msg ok" id="topSuccess"></div>
      </div>
    </div>

    <div class="card">
      <div class="card-head">
        <h2>Questions (10)</h2>
        <div class="hint">3 multiple choice + 7 written</div>
      </div>
      <div class="card-body">

        <!-- Q1 MCQ -->
        <section class="q" data-qblock>
          <div class="q-top">
            <div class="q-num">1</div>
            <div style="flex:1">
              <p class="q-text">In a spreadsheet, what is a <strong>cell</strong>?</p>
              <p class="q-sub">Choose one answer.</p>
            </div>
          </div>
          <div class="choices">
            <label class="choice"><input type="radio" name="q1" value="A" /> <span>A box where a row and column meet</span></label>
            <label class="choice"><input type="radio" name="q1" value="B" /> <span>A file folder on the computer</span></label>
            <label class="choice"><input type="radio" name="q1" value="C" /> <span>A type of printer</span></label>
            <label class="choice"><input type="radio" name="q1" value="D" /> <span>A font style in Word</span></label>
          </div>
        </section>

        <!-- Q2 -->
        <section class="q" data-qblock>
          <div class="q-top">
            <div class="q-num">2</div>
            <div style="flex:1">
              <p class="q-text">Write the cell reference for <strong>column B, row 6</strong>.</p>
              <p class="q-sub">Example format: A1</p>
            </div>
          </div>
          <input type="text" id="q2" placeholder="Type your answer..." />
        </section>

        <!-- Q3 MCQ -->
        <section class="q" data-qblock>
          <div class="q-top">
            <div class="q-num">3</div>
            <div style="flex:1">
              <p class="q-text">Which symbol starts most spreadsheet formulas?</p>
              <p class="q-sub">Choose one answer.</p>
            </div>
          </div>
          <div class="choices">
            <label class="choice"><input type="radio" name="q3" value="A" /> <span>@</span></label>
            <label class="choice"><input type="radio" name="q3" value="B" /> <span>=</span></label>
            <label class="choice"><input type="radio" name="q3" value="C" /> <span>#</span></label>
            <label class="choice"><input type="radio" name="q3" value="D" /> <span>!</span></label>
          </div>
        </section>

        <!-- Q4 -->
        <section class="q" data-qblock>
          <div class="q-top">
            <div class="q-num">4</div>
            <div style="flex:1">
              <p class="q-text">Explain what the <strong>SUM</strong> function does in a spreadsheet.</p>
              <p class="q-sub">One sentence is enough.</p>
            </div>
          </div>
          <textarea id="q4" placeholder="Type your answer..."></textarea>
        </section>

        <!-- Q5 MCQ -->
        <section class="q" data-qblock>
          <div class="q-top">
            <div class="q-num">5</div>
            <div style="flex:1">
              <p class="q-text">What is the best tool to make a title stand out in a Word document?</p>
              <p class="q-sub">Choose one answer.</p>
            </div>
          </div>
          <div class="choices">
            <label class="choice"><input type="radio" name="q5" value="A" /> <span>Increase font size and use bold (or a heading style)</span></label>
            <label class="choice"><input type="radio" name="q5" value="B" /> <span>Turn off spell check</span></label>
            <label class="choice"><input type="radio" name="q5" value="C" /> <span>Delete margins</span></label>
            <label class="choice"><input type="radio" name="q5" value="D" /> <span>Close the document and reopen it</span></label>
          </div>
        </section>

        <!-- Q6 -->
        <section class="q" data-qblock>
          <div class="q-top">
            <div class="q-num">6</div>
            <div style="flex:1">
              <p class="q-text">In Word, what is a <strong>bullet point</strong> used for?</p>
              <p class="q-sub">Write a short answer.</p>
            </div>
          </div>
          <input type="text" id="q6" placeholder="Type your answer..." />
        </section>

        <!-- Q7 -->
        <section class="q" data-qblock>
          <div class="q-top">
            <div class="q-num">7</div>
            <div style="flex:1">
              <p class="q-text">A spreadsheet has names in column A and test scores in column B. What would you do to find the <strong>highest score</strong>?</p>
              <p class="q-sub">You can name a function or a feature.</p>
            </div>
          </div>
          <textarea id="q7" placeholder="Type your answer..."></textarea>
        </section>

        <!-- Q8 MCQ -->
        <section class="q" data-qblock>
          <div class="q-top">
            <div class="q-num">8</div>
            <div style="flex:1">
              <p class="q-text">What does <strong>copy &amp; paste</strong> do?</p>
              <p class="q-sub">Choose one answer.</p>
            </div>
          </div>
          <div class="choices">
            <label class="choice"><input type="radio" name="q8" value="A" /> <span>Moves text and deletes the original</span></label>
            <label class="choice"><input type="radio" name="q8" value="B" /> <span>Makes a duplicate of text/data and puts it somewhere else</span></label>
            <label class="choice"><input type="radio" name="q8" value="C" /> <span>Turns text into a table</span></label>
            <label class="choice"><input type="radio" name="q8" value="D" /> <span>Changes font to italic</span></label>
          </div>
        </section>

        <!-- Q9 -->
        <section class="q" data-qblock>
          <div class="q-top">
            <div class="q-num">9</div>
            <div style="flex:1">
              <p class="q-text">Why is it useful to use a <strong>table</strong> in Word?</p>
              <p class="q-sub">Write one benefit.</p>
            </div>
          </div>
          <input type="text" id="q9" placeholder="Type your answer..." />
        </section>

        <!-- Q10 -->
        <section class="q" data-qblock>
          <div class="q-top">
            <div class="q-num">10</div>
            <div style="flex:1">
              <p class="q-text">Describe one way to make a spreadsheet easier to read.</p>
              <p class="q-sub">Example: headings, borders, alignment, colours, formatting.</p>
            </div>
          </div>
          <textarea id="q10" placeholder="Type your answer..."></textarea>
        </section>

        <div class="actions">
          <div class="status" id="statusText">Complete all fields to enable <strong>Submit</strong>.</div>
          <div style="display:flex; gap:10px; flex-wrap:wrap; justify-content:flex-end">
            <button type="button" class="btn-ghost" id="clearBtn">Clear</button>
            <button type="button" class="btn-primary" id="submitBtn" disabled>Submit</button>
          </div>
        </div>

        <div class="msg err" id="bottomError"></div>
      </div>
    </div>
  </div>

  <!-- EVERYTHING (Firebase + Submit Logic) is below -->
  <script type="module">
    // ---------------------------
    // Firebase Firestore (GitHub Pages compatible)
    // ---------------------------
    import { initializeApp } from "https://www.gstatic.com/firebasejs/12.9.0/firebase-app.js";
    import { getFirestore, collection, addDoc, serverTimestamp } from "https://www.gstatic.com/firebasejs/12.9.0/firebase-firestore.js";

    const firebaseConfig = {
      apiKey: "AIzaSyCyjHGKmWqtvRn6ikJxWQeCAocbGIZqS3Y",
      authDomain: "mmmm-7a485.firebaseapp.com",
      projectId: "mmmm-7a485",
      storageBucket: "mmmm-7a485.firebasestorage.app",
      messagingSenderId: "177735973547",
      appId: "1:177735973547:web:0d9ea6f476b886ab6195ee",
      measurementId: "G-6L8D7VD967"
    };

    const app = initializeApp(firebaseConfig);
    const db = getFirestore(app);

    async function saveToFirestore(payload) {
      await addDoc(collection(db, "submissions"), {
        ...payload,
        createdAt: serverTimestamp(),
        pageUrl: location.href
      });
    }

    // ---------------------------
    // Worksheet logic
    // ---------------------------
    const firstName = document.getElementById("firstName");
    const secondName = document.getElementById("secondName");
    const submitBtn = document.getElementById("submitBtn");
    const clearBtn = document.getElementById("clearBtn");
    const answeredCountEl = document.getElementById("answeredCount");
    const statusText = document.getElementById("statusText");

    const topError = document.getElementById("topError");
    const bottomError = document.getElementById("bottomError");
    const topSuccess = document.getElementById("topSuccess");

    const TOTAL_REQUIRED = 12; // 2 names + 10 answers

    function msg(el, text, type) {
      el.textContent = text;
      el.classList.remove("show", "err", "ok");
      if (text) {
        el.classList.add("show");
        el.classList.add(type);
      }
    }

    function clearMsgs() {
      msg(topError, "", "err");
      msg(bottomError, "", "err");
      msg(topSuccess, "", "ok");
    }

    function isNonEmptyValue(v) { return (v || "").trim().length > 0; }
    function isNonEmpty(el) { return isNonEmptyValue(el.value); }

    function radioChecked(name) {
      return document.querySelector(`input[name="${CSS.escape(name)}"]:checked`);
    }

    function setInvalid(el, on) { on ? el.classList.add("invalid") : el.classList.remove("invalid"); }
    function setBlockInvalid(block, on) { on ? block.classList.add("invalid-block") : block.classList.remove("invalid-block"); }

    function scrollTo(el) {
      el.scrollIntoView({ behavior: "smooth", block: "center" });
      if (typeof el.focus === "function") setTimeout(() => el.focus({ preventScroll: true }), 200);
    }

    function computeAnswered() {
      let n = 0;
      if (isNonEmpty(firstName)) n++;
      if (isNonEmpty(secondName)) n++;

      if (radioChecked("q1")) n++;
      if (isNonEmptyValue(document.getElementById("q2").value)) n++;
      if (radioChecked("q3")) n++;
      if (isNonEmptyValue(document.getElementById("q4").value)) n++;
      if (radioChecked("q5")) n++;
      if (isNonEmptyValue(document.getElementById("q6").value)) n++;
      if (isNonEmptyValue(document.getElementById("q7").value)) n++;
      if (radioChecked("q8")) n++;
      if (isNonEmptyValue(document.getElementById("q9").value)) n++;
      if (isNonEmptyValue(document.getElementById("q10").value)) n++;

      return n;
    }

    function updateProgress() {
      const answered = computeAnswered();
      answeredCountEl.textContent = String(answered);

      const ready = answered === TOTAL_REQUIRED;
      submitBtn.disabled = !ready;

      statusText.innerHTML = ready
        ? `All done! You can now <strong>Submit</strong>.`
        : `Complete all fields to enable <strong>Submit</strong>. (${answered}/${TOTAL_REQUIRED})`;
    }

    function buildPayload() {
      const fn = firstName.value.trim();
      const sn = secondName.value.trim();

      return {
        timestamp: new Date().toISOString(),
        firstName: fn,
        secondName: sn,
        fullName: `${fn} ${sn}`.trim(),
        worksheet: document.title || "Worksheet",

        q1: radioChecked("q1")?.value || "",
        q2: document.getElementById("q2").value.trim(),
        q3: radioChecked("q3")?.value || "",
        q4: document.getElementById("q4").value.trim(),
        q5: radioChecked("q5")?.value || "",
        q6: document.getElementById("q6").value.trim(),
        q7: document.getElementById("q7").value.trim(),
        q8: radioChecked("q8")?.value || "",
        q9: document.getElementById("q9").value.trim(),
        q10: document.getElementById("q10").value.trim()
      };
    }

    function validateAll() {
      clearMsgs();

      // clear all previous red highlights
      document.querySelectorAll(".invalid").forEach(el => el.classList.remove("invalid"));
      document.querySelectorAll("[data-qblock].invalid-block").forEach(el => el.classList.remove("invalid-block"));

      const missing = [];
      const blocks = Array.from(document.querySelectorAll("[data-qblock]"));

      if (!isNonEmpty(firstName)) { setInvalid(firstName, true); missing.push({ el: firstName, label: "First name" }); }
      if (!isNonEmpty(secondName)) { setInvalid(secondName, true); missing.push({ el: secondName, label: "Second name" }); }

      // Q1
      if (!radioChecked("q1")) { setBlockInvalid(blocks[0], true); missing.push({ el: blocks[0], label: "Question 1" }); }
      // Q2
      const q2 = document.getElementById("q2");
      if (!isNonEmpty(q2)) { setBlockInvalid(blocks[1], true); setInvalid(q2, true); missing.push({ el: q2, label: "Question 2" }); }
      // Q3
      if (!radioChecked("q3")) { setBlockInvalid(blocks[2], true); missing.push({ el: blocks[2], label: "Question 3" }); }
      // Q4
      const q4 = document.getElementById("q4");
      if (!isNonEmpty(q4)) { setBlockInvalid(blocks[3], true); setInvalid(q4, true); missing.push({ el: q4, label: "Question 4" }); }
      // Q5
      if (!radioChecked("q5")) { setBlockInvalid(blocks[4], true); missing.push({ el: blocks[4], label: "Question 5" }); }
      // Q6
      const q6 = document.getElementById("q6");
      if (!isNonEmpty(q6)) { setBlockInvalid(blocks[5], true); setInvalid(q6, true); missing.push({ el: q6, label: "Question 6" }); }
      // Q7
      const q7 = document.getElementById("q7");
      if (!isNonEmpty(q7)) { setBlockInvalid(blocks[6], true); setInvalid(q7, true); missing.push({ el: q7, label: "Question 7" }); }
      // Q8
      if (!radioChecked("q8")) { setBlockInvalid(blocks[7], true); missing.push({ el: blocks[7], label: "Question 8" }); }
      // Q9
      const q9 = document.getElementById("q9");
      if (!isNonEmpty(q9)) { setBlockInvalid(blocks[8], true); setInvalid(q9, true); missing.push({ el: q9, label: "Question 9" }); }
      // Q10
      const q10 = document.getElementById("q10");
      if (!isNonEmpty(q10)) { setBlockInvalid(blocks[9], true); setInvalid(q10, true); missing.push({ el: q10, label: "Question 10" }); }

      if (missing.length) {
        const first = missing[0];
        msg(bottomError, "Please complete all required fields. Missing: " + missing.map(m => m.label).join(", "), "err");
        scrollTo(first.el);
        return false;
      }
      return true;
    }

    function disableAllInputs() {
      document.querySelectorAll("input, textarea, button").forEach(el => {
        // keep the success message visible; disable all inputs
        if (el.id !== "clearBtn") el.disabled = true;
      });
      clearBtn.disabled = true;
    }

    // Live progress events
    document.querySelectorAll('input[type="text"], textarea').forEach(el => {
      el.addEventListener("input", () => { if (isNonEmpty(el)) el.classList.remove("invalid"); updateProgress(); });
      el.addEventListener("blur", () => { if (!isNonEmpty(el)) el.classList.add("invalid"); });
    });
    document.querySelectorAll('input[type="radio"]').forEach(el => {
      el.addEventListener("change", () => {
        const block = el.closest("[data-qblock]");
        if (block) block.classList.remove("invalid-block");
        updateProgress();
      });
    });

    clearBtn.addEventListener("click", () => {
      if (!confirm("Clear all answers?")) return;

      clearMsgs();
      document.querySelectorAll('input[type="text"], textarea').forEach(el => el.value = "");
      document.querySelectorAll('input[type="radio"]').forEach(el => el.checked = false);
      document.querySelectorAll(".invalid").forEach(el => el.classList.remove("invalid"));
      document.querySelectorAll("[data-qblock].invalid-block").forEach(el => el.classList.remove("invalid-block"));
      updateProgress();
      window.scrollTo({ top: 0, behavior: "smooth" });
    });

    submitBtn.addEventListener("click", async () => {
      clearMsgs();
      const ok = validateAll();
      updateProgress();
      if (!ok) return;

      // lock button
      submitBtn.disabled = true;
      submitBtn.textContent = "Submitting...";

      try {
        const payload = buildPayload();
        await saveToFirestore(payload);

        msg(topSuccess, "✅ Submitted successfully! You can close this page now.", "ok");
        disableAllInputs();
        window.scrollTo({ top: 0, behavior: "smooth" });

      } catch (e) {
        console.error(e);
        msg(topError, "❌ Submit failed. Please refresh and try again.", "err");
        submitBtn.textContent = "Submit";
        updateProgress();
      }
    });

    // init
    updateProgress();
  </script>
</body>
</html>
